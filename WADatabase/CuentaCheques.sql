      

--Fecha Creación:5/24/2019 6:13:00 PM Template TableAndStoreds, Author: Alfredo Reyes C., V1

IF OBJECT_ID('[dbo].[CuentaCheques]', 'U') IS NOT NULL 
Drop Table [dbo].[CuentaCheques]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spDeleteCuentaCheques]') AND type in (N'P', N'PC'))
    Drop Procedure spDeleteCuentaCheques
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spUpdateCuentaCheques]') AND type in (N'P', N'PC'))
    Drop Procedure spUpdateCuentaCheques
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spUpdatePartialCuentaCheques]') AND type in (N'P', N'PC'))
    Drop Procedure spUpdatePartialCuentaCheques
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spInsertCuentaCheques]') AND type in (N'P', N'PC'))
    Drop Procedure spInsertCuentaCheques
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetListCuentaChequesPaged]') AND type in (N'P', N'PC'))
    Drop Procedure spGetListCuentaChequesPaged
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetListCuentaChequesAndRelationsPaged]') AND type in (N'P', N'PC'))
    Drop Procedure spGetListCuentaChequesAndRelationsPaged
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetCuentaChequesByID]') AND type in (N'P', N'PC'))
    Drop Procedure spGetCuentaChequesByID
GO


-------------------------------------------------//////////////////--------------------------------------------------------------------
----Datos para la seguridad de los servicios
-----------------------------------------------------

-------------------------------------------------//////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
--Add Columns to Table must be null 



-------------------------------------------------/////////CREAR TABLA/////////--------------------------------------------------------------------
-------------------------------------------------//////////////////--------------------------------------------------------------------
--CRUD Tabla SQL
Create Table [dbo].[CuentaCheques](
                        [ID] int--%>
                        IDENTITY (1,1)  ,
            
                   
 [Fideicomiso] int
                NOT NULL ,
       
 [TipoPersona] varchar(250)
                NOT NULL ,
       
 [Fideicomitente] int
                NOT NULL ,
       
 [TipoCuenta] varchar(250)
                NOT NULL ,
       
 [TipoPago] varchar(250)
                NULL ,
       
 [BancoSpei] varchar(250)
                NULL ,
       
 [Banco] varchar(250)
                NULL ,
       
 [DomBanco] varchar(250)
                NULL ,
       
 [Moneda] varchar(250)
                NULL ,
       
 [ClaveVostro] varchar(250)
                NULL ,
       
 [NumCuenta] varchar(250)
                NULL ,
       
 [DomBeneficiario] varchar(250)
                NULL ,
       
 [PlazaInternacional] varchar(250)
                NULL ,
       
 [Pais] varchar(250)
                NULL ,
       
 [ClaveSiacInst] varchar(250)
                NULL ,
       
 [ConvenioCieDie] varchar(250)
                NULL ,
       
 [Estatus] varchar(250)
                NULL ,
       
 [Clabe] varchar(250)
                NULL ,
       
 [CuentaChequera] varchar(250)
                NOT NULL ,
       
 [FechaVence] varchar(250)
                NULL ,
       
 [NumAbbasSwift] varchar(250)
                NULL ,
       
 [ConceptoSiac] varchar(250)
                NULL ,
       
 [RefCieDie] varchar(250)
                NULL ,
       
 [Autorizacion] varchar(250)
                NULL 
       
    CONSTRAINT [PK_CuentaCheques] PRIMARY KEY CLUSTERED
    (
    [ID] ASC
        )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
        ) ON [PRIMARY]

GO


---Añadimos lo constraints de ForeignKeys 
        ALTER TABLE [dbo].[CuentaCheques]  WITH CHECK ADD FOREIGN KEY([Fideicomiso])
        REFERENCES [dbo].[Fideicomiso] ([ID])
        GO
        ALTER TABLE [dbo].[CuentaCheques]  WITH CHECK ADD FOREIGN KEY([Fideicomitente])
        REFERENCES [dbo].[Fideicomitente] ([ID])
        GO


-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////////DELETE SP//////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
--CRUD Stored Procedures

Create Procedure [dbo].[spDeleteCuentaCheques]
    @ID int,
    @ReturnValue int output,
    @numhijos int output
AS
BEGIN
    SET NOCOUNT ON;
    set @numhijos = 0;
      
      
        
    if @numhijos > 0
	Begin
		select @ReturnValue = 0;	
	End
	else
		BEGIN TRY
			 delete from CuentaCheques where ID = @ID;
				select @ReturnValue = 1;	
		END TRY
        BEGIN CATCH
        if ERROR_NUMBER()  = 547
    	begin 
    		select @ReturnValue = 0;
            select @numhijos = 1;
    	end
    	else
    		THROW;
	
	
        END CATCH;
        
END

GO
-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------/////////Insert SP/////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spInsertCuentaCheques]
      @Fideicomiso int  ,
@TipoPersona varchar(250)  ,
@Fideicomitente int  ,
@TipoCuenta varchar(250)  ,
@TipoPago varchar(250) NULL ,
@BancoSpei varchar(250) NULL ,
@Banco varchar(250) NULL ,
@DomBanco varchar(250) NULL ,
@Moneda varchar(250) NULL ,
@ClaveVostro varchar(250) NULL ,
@NumCuenta varchar(250) NULL ,
@DomBeneficiario varchar(250) NULL ,
@PlazaInternacional varchar(250) NULL ,
@Pais varchar(250) NULL ,
@ClaveSiacInst varchar(250) NULL ,
@ConvenioCieDie varchar(250) NULL ,
@Estatus varchar(250) NULL ,
@Clabe varchar(250) NULL ,
@CuentaChequera varchar(250)  ,
@FechaVence varchar(250) NULL ,
@NumAbbasSwift varchar(250) NULL ,
@ConceptoSiac varchar(250) NULL ,
@RefCieDie varchar(250) NULL ,
@Autorizacion varchar(250) NULL ,
    @ReturnValue int output
AS
BEGIN
   
    SET NOCOUNT ON;
    Insert into CuentaCheques (
     Fideicomiso,TipoPersona,Fideicomitente,TipoCuenta,TipoPago,BancoSpei,Banco,DomBanco,Moneda,ClaveVostro,NumCuenta,DomBeneficiario,PlazaInternacional,Pais,ClaveSiacInst,ConvenioCieDie,Estatus,Clabe,CuentaChequera,FechaVence,NumAbbasSwift,ConceptoSiac,RefCieDie,Autorizacion
    )     
    values (  
    @Fideicomiso,@TipoPersona,@Fideicomitente,@TipoCuenta,@TipoPago,@BancoSpei,@Banco,@DomBanco,@Moneda,@ClaveVostro,@NumCuenta,@DomBeneficiario,@PlazaInternacional,@Pais,@ClaveSiacInst,@ConvenioCieDie,@Estatus,@Clabe,@CuentaChequera,@FechaVence,@NumAbbasSwift,@ConceptoSiac,@RefCieDie,@Autorizacion
    );

		--select @ReturnValue = Max(ID) from CuentaCheques;
        select @ReturnValue = 1;
END

GO

-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////////Update SP//////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spUpdateCuentaCheques]
      @ID int ,
@Fideicomiso int ,
@TipoPersona varchar(250) ,
@Fideicomitente int ,
@TipoCuenta varchar(250) ,
@TipoPago varchar(250) NULL,
@BancoSpei varchar(250) NULL,
@Banco varchar(250) NULL,
@DomBanco varchar(250) NULL,
@Moneda varchar(250) NULL,
@ClaveVostro varchar(250) NULL,
@NumCuenta varchar(250) NULL,
@DomBeneficiario varchar(250) NULL,
@PlazaInternacional varchar(250) NULL,
@Pais varchar(250) NULL,
@ClaveSiacInst varchar(250) NULL,
@ConvenioCieDie varchar(250) NULL,
@Estatus varchar(250) NULL,
@Clabe varchar(250) NULL,
@CuentaChequera varchar(250) ,
@FechaVence varchar(250) NULL,
@NumAbbasSwift varchar(250) NULL,
@ConceptoSiac varchar(250) NULL,
@RefCieDie varchar(250) NULL,
@Autorizacion varchar(250) NULL,
    @ReturnValue int output
AS
BEGIN
    SET NOCOUNT ON;
    Update CuentaCheques set 
        Fideicomiso = @Fideicomiso,TipoPersona = @TipoPersona,Fideicomitente = @Fideicomitente,TipoCuenta = @TipoCuenta,TipoPago = @TipoPago,BancoSpei = @BancoSpei,Banco = @Banco,DomBanco = @DomBanco,Moneda = @Moneda,ClaveVostro = @ClaveVostro,NumCuenta = @NumCuenta,DomBeneficiario = @DomBeneficiario,PlazaInternacional = @PlazaInternacional,Pais = @Pais,ClaveSiacInst = @ClaveSiacInst,ConvenioCieDie = @ConvenioCieDie,Estatus = @Estatus,Clabe = @Clabe,CuentaChequera = @CuentaChequera,FechaVence = @FechaVence,NumAbbasSwift = @NumAbbasSwift,ConceptoSiac = @ConceptoSiac,RefCieDie = @RefCieDie,Autorizacion = @Autorizacion
    where ID = @ID;

		select @ReturnValue = 1;
END

GO
-------------------------------------------------/////////////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------/////////////Update SP Partial///////////--------------------------------------------------------------------
-------------------------------------------------////////////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spUpdatePartialCuentaCheques]
      @ID int ,
@Fideicomiso int ,
@TipoPersona varchar(250) ,
@Fideicomitente int ,
@TipoCuenta varchar(250) ,
@TipoPago varchar(250) NULL,
@BancoSpei varchar(250) NULL,
@Banco varchar(250) NULL,
@DomBanco varchar(250) NULL,
@Moneda varchar(250) NULL,
@ClaveVostro varchar(250) NULL,
@NumCuenta varchar(250) NULL,
@DomBeneficiario varchar(250) NULL,
@PlazaInternacional varchar(250) NULL,
@Pais varchar(250) NULL,
@ClaveSiacInst varchar(250) NULL,
@ConvenioCieDie varchar(250) NULL,
@Estatus varchar(250) NULL,
@Clabe varchar(250) NULL,
@CuentaChequera varchar(250) ,
@FechaVence varchar(250) NULL,
@NumAbbasSwift varchar(250) NULL,
@ConceptoSiac varchar(250) NULL,
@RefCieDie varchar(250) NULL,
@Autorizacion varchar(250) NULL,
    @ReturnValue int output
AS
BEGIN
    SET NOCOUNT ON;
    Update CuentaCheques set 
        Fideicomiso = @Fideicomiso,TipoPersona = @TipoPersona,Fideicomitente = @Fideicomitente,TipoCuenta = @TipoCuenta,TipoPago = @TipoPago,BancoSpei = @BancoSpei,Banco = @Banco,DomBanco = @DomBanco,Moneda = @Moneda,ClaveVostro = @ClaveVostro,NumCuenta = @NumCuenta,DomBeneficiario = @DomBeneficiario,PlazaInternacional = @PlazaInternacional,Pais = @Pais,ClaveSiacInst = @ClaveSiacInst,ConvenioCieDie = @ConvenioCieDie,Estatus = @Estatus,Clabe = @Clabe,CuentaChequera = @CuentaChequera,FechaVence = @FechaVence,NumAbbasSwift = @NumAbbasSwift,ConceptoSiac = @ConceptoSiac,RefCieDie = @RefCieDie,Autorizacion = @Autorizacion
    where ID = @ID;

		select @ReturnValue = 1;
END

GO
-------------------------------------------------////////////////////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad Rwlations SP//////////--------------------------------------------------------------------
-------------------------------------------------////////////////////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:00 PM
-- CRUD Stored Procedures spGetListEntidadSQLAndRelationsPaged
Create Procedure [dbo].[spGetListCuentaChequesAndRelationsPaged]
     @pagNo int, 
    @pageSize int,
    @sort varchar(50) = '',
	@sortdir varchar(10) = ''
AS
BEGIN

  SET NOCOUNT ON;
   declare @ReturnCount int;
    select @ReturnCount = count(ID) from CuentaCheques;
    
            if @sort = 'CuentaCheques_ID' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ID
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ID' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ID desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
                
            if @sort = '' 
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ID
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
                 
            if @sort = 'MyFideicomiso1.Fideicomiso_GeneralesNumero' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY Fideicomiso1.GeneralesNumero
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'MyFideicomiso1.Fideicomiso_GeneralesNumero' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY Fideicomiso1.GeneralesNumero desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoPersona' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoPersona
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoPersona' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoPersona desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'MyFideicomitente2.Fideicomitente_NumeroFideicomitente' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY Fideicomitente2.NumeroFideicomitente
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'MyFideicomitente2.Fideicomitente_NumeroFideicomitente' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY Fideicomitente2.NumeroFideicomitente desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoCuenta' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoCuenta
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoCuenta' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoCuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoPago' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoPago
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoPago' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.TipoPago desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_BancoSpei' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.BancoSpei
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_BancoSpei' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.BancoSpei desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Banco' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Banco
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Banco' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Banco desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_DomBanco' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.DomBanco
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_DomBanco' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.DomBanco desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Moneda' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Moneda
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Moneda' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Moneda desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ClaveVostro' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ClaveVostro
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ClaveVostro' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ClaveVostro desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_NumCuenta' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.NumCuenta
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_NumCuenta' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.NumCuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_DomBeneficiario' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.DomBeneficiario
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_DomBeneficiario' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.DomBeneficiario desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_PlazaInternacional' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.PlazaInternacional
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_PlazaInternacional' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.PlazaInternacional desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Pais' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Pais
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Pais' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Pais desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ClaveSiacInst' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ClaveSiacInst
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ClaveSiacInst' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ClaveSiacInst desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ConvenioCieDie' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ConvenioCieDie
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ConvenioCieDie' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ConvenioCieDie desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Estatus' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Estatus
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Estatus' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Estatus desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Clabe' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Clabe
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Clabe' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Clabe desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_CuentaChequera' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.CuentaChequera
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_CuentaChequera' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.CuentaChequera desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_FechaVence' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.FechaVence
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_FechaVence' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.FechaVence desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_NumAbbasSwift' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.NumAbbasSwift
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_NumAbbasSwift' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.NumAbbasSwift desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ConceptoSiac' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ConceptoSiac
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ConceptoSiac' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.ConceptoSiac desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_RefCieDie' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.RefCieDie
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_RefCieDie' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.RefCieDie desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Autorizacion' and @sortdir = 'ASC'
            Begin
               SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Autorizacion
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Autorizacion' and @sortdir <> 'ASC'
            Begin
                SELECT CuentaCheques.ID,CuentaCheques.Fideicomiso,CuentaCheques.TipoPersona,CuentaCheques.Fideicomitente,CuentaCheques.TipoCuenta,CuentaCheques.TipoPago,CuentaCheques.BancoSpei,CuentaCheques.Banco,CuentaCheques.DomBanco,CuentaCheques.Moneda,CuentaCheques.ClaveVostro,CuentaCheques.NumCuenta,CuentaCheques.DomBeneficiario,CuentaCheques.PlazaInternacional,CuentaCheques.Pais,CuentaCheques.ClaveSiacInst,CuentaCheques.ConvenioCieDie,CuentaCheques.Estatus,CuentaCheques.Clabe,CuentaCheques.CuentaChequera,CuentaCheques.FechaVence,CuentaCheques.NumAbbasSwift,CuentaCheques.ConceptoSiac,CuentaCheques.RefCieDie,CuentaCheques.Autorizacion,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Fideicomitente2.ID as ID2,Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2,Fideicomitente2.TipoPersona as TipoPersona2,Fideicomitente2.Participante as Participante2,Fideicomitente2.Fideicomiso as Fideicomiso2,Fideicomitente2.RegimenFiscal as RegimenFiscal2,Fideicomitente2.GeneralesControladorFideicomiso as GeneralesControladorFideicomiso2,Fideicomitente2.GeneralesNacionalidad as GeneralesNacionalidad2,Fideicomitente2.GeneralesPaisOrigen as GeneralesPaisOrigen2,Fideicomitente2.GeneralesActividad as GeneralesActividad2,Fideicomitente2.GeneralesAportaRecursos as GeneralesAportaRecursos2,Fideicomitente2.GeneralesPaisResidencia as GeneralesPaisResidencia2,Fideicomitente2.GeneralesClienteScotiaBank as GeneralesClienteScotiaBank2,Fideicomitente2.GeneralesPep as GeneralesPep2,Fideicomitente2.GeneralesEstatus as GeneralesEstatus2,Fideicomitente2.GeneralesGrupoFilial as GeneralesGrupoFilial2,Fideicomitente2.GeneralesCalidadMigratoria as GeneralesCalidadMigratoria2,Fideicomitente2.GeneralesLugarOperacion as GeneralesLugarOperacion2,Fideicomitente2.GeneralesOperaCuentaTerceros as GeneralesOperaCuentaTerceros2,Fideicomitente2.GeneralesNivelParticipante as GeneralesNivelParticipante2,Fideicomitente2.GeneralesClienteRelacionPep as GeneralesClienteRelacionPep2,Fideicomitente2.GeneralesGrado as GeneralesGrado2,Fideicomitente2.InfoPldKycHonorarios as InfoPldKycHonorarios2,Fideicomitente2.InfoPldKycComisiones as InfoPldKycComisiones2,Fideicomitente2.InfoPldKycOtros as InfoPldKycOtros2,Fideicomitente2.InfoPldKycSueldos as InfoPldKycSueldos2,Fideicomitente2.InfoPldKycVenta as InfoPldKycVenta2,Fideicomitente2.InfoPldKycInversiones as InfoPldKycInversiones2,Fideicomitente2.InfoPldKycArrendamiento as InfoPldKycArrendamiento2,Fideicomitente2.InfoPldKycTipoPatrimonio as InfoPldKycTipoPatrimonio2,Fideicomitente2.InfoPldKycInstrumento as InfoPldKycInstrumento2,Fideicomitente2.InfoPldKycRazonApertura as InfoPldKycRazonApertura2,Fideicomitente2.InfoPldKycComentarios as InfoPldKycComentarios2,Fideicomitente2.InfoPldKycNivelRiesgo as InfoPldKycNivelRiesgo2,Fideicomitente2.InfoPldKycEstatusCalculoPld as InfoPldKycEstatusCalculoPld2,Fideicomitente2.InfoPldKycFechaVerifFircosoft as InfoPldKycFechaVerifFircosoft2,Fideicomitente2.IdentificacionRfc as IdentificacionRfc2,Fideicomitente2.IdentificacionCurp as IdentificacionCurp2,Fideicomitente2.IdentificacionNoSerieEfirma as IdentificacionNoSerieEfirma2,Fideicomitente2.IdentificacionPaisResidFisc1 as IdentificacionPaisResidFisc12,Fideicomitente2.IdentificacionPaisResidFisc2 as IdentificacionPaisResidFisc22,Fideicomitente2.IdentificacionEmail as IdentificacionEmail2,Fideicomitente2.IdentificacionFechaConstitucion as IdentificacionFechaConstitucion2,Fideicomitente2.IdentificacionSexo as IdentificacionSexo2,Fideicomitente2.IdentificacionPaisCasa as IdentificacionPaisCasa2,Fideicomitente2.IdentificacionPaisOficina as IdentificacionPaisOficina2,Fideicomitente2.IdentificacionPaisCelular as IdentificacionPaisCelular2,Fideicomitente2.IdentificacionFechaInicioRelNeg as IdentificacionFechaInicioRelNeg2,Fideicomitente2.IdentificacionNoIdentificacion as IdentificacionNoIdentificacion2,Fideicomitente2.IdentificacionComprobacionDomicilio as IdentificacionComprobacionDomicilio2,Fideicomitente2.IdentificacionActividadEmpresarial as IdentificacionActividadEmpresarial2,Fideicomitente2.IdentificacionNoIdentFisc1 as IdentificacionNoIdentFisc12,Fideicomitente2.IdentificacionNoIdentFisc2 as IdentificacionNoIdentFisc22,Fideicomitente2.IdentificacionClasificacionFatca as IdentificacionClasificacionFatca2,Fideicomitente2.IdentificacionLadaCasa as IdentificacionLadaCasa2,Fideicomitente2.IdentificacionLadaOficina as IdentificacionLadaOficina2,Fideicomitente2.IdentificacionLadaCelular as IdentificacionLadaCelular2,Fideicomitente2.IdentificacionNumeroCasa as IdentificacionNumeroCasa2,Fideicomitente2.IdentificacionNumeroOficina as IdentificacionNumeroOficina2,Fideicomitente2.IdentificacionNumeroCelular as IdentificacionNumeroCelular2,Fideicomitente2.IdentificacionExtOficina as IdentificacionExtOficina2,Fideicomitente2.IdentificacionExtCelular as IdentificacionExtCelular2,Fideicomitente2.IdentificacionIdentOficialVig as IdentificacionIdentOficialVig2,Fideicomitente2.IdentificacionVigencia as IdentificacionVigencia2,Fideicomitente2.EscrituraNoEscritura as EscrituraNoEscritura2,Fideicomitente2.EscrituraNotario as EscrituraNotario2,Fideicomitente2.EscrituraNoNotaria as EscrituraNoNotaria2,Fideicomitente2.EscrituraCiudad as EscrituraCiudad2,Fideicomitente2.EscrituraTelefono as EscrituraTelefono2,Fideicomitente2.EscrituraEmail as EscrituraEmail2,Fideicomitente2.EscrituraFecha as EscrituraFecha2,Fideicomitente2.EscrituraEstado as EscrituraEstado2,Fideicomitente2.CuentasKYCNoCuenta1 as CuentasKYCNoCuenta12,Fideicomitente2.CuentasKYCTipoCuenta1 as CuentasKYCTipoCuenta12,Fideicomitente2.CuentasKYCNoCuenta2 as CuentasKYCNoCuenta22,Fideicomitente2.CuentasKYCTipoCuenta2 as CuentasKYCTipoCuenta22,Fideicomitente2.CuentasKYCNoCuenta3 as CuentasKYCNoCuenta32,Fideicomitente2.CuentasKYCTipoCuenta3 as CuentasKYCTipoCuenta32,Fideicomitente2.CuentasKYCNoCuenta4 as CuentasKYCNoCuenta42,Fideicomitente2.CuentasKYCTipoCuenta4 as CuentasKYCTipoCuenta42,@ReturnCount as TotalRecords
                FROM CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

                ORDER BY CuentaCheques.Autorizacion desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
 
      
        
END

GO
-------------------------------------------------///////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad//////////--------------------------------------------------------------------
-------------------------------------------------//////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:01 PM
-- CRUD Stored Procedures spGetListEntidadSQLPaged
Create Procedure [dbo].[spGetListCuentaChequesPaged]
     @pagNo int, 
    @pageSize int,
    @sort varchar(50) = '',
	@sortdir varchar(10) = ''
AS
BEGIN

 SET NOCOUNT ON;
   declare @ReturnCount int;
    select @ReturnCount = count(ID) from CuentaCheques;
    
            if @sort = 'CuentaCheques_ID' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ID 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ID' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ID desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
                if @sort = ''
                Begin
                   SELECT *,@ReturnCount as TotalRecords
                    FROM CuentaCheques
                    ORDER BY ID 
                    OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                    FETCH NEXT @pageSize  ROWS ONLY;

              End
            if @sort = 'CuentaCheques_Fideicomiso' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Fideicomiso 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Fideicomiso' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Fideicomiso desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoPersona' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoPersona 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoPersona' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoPersona desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Fideicomitente' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Fideicomitente 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Fideicomitente' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Fideicomitente desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoCuenta' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoCuenta 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoCuenta' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoCuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_TipoPago' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoPago 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_TipoPago' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY TipoPago desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_BancoSpei' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY BancoSpei 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_BancoSpei' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY BancoSpei desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Banco' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Banco 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Banco' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Banco desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_DomBanco' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY DomBanco 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_DomBanco' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY DomBanco desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Moneda' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Moneda 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Moneda' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Moneda desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ClaveVostro' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ClaveVostro 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ClaveVostro' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ClaveVostro desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_NumCuenta' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY NumCuenta 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_NumCuenta' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY NumCuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_DomBeneficiario' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY DomBeneficiario 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_DomBeneficiario' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY DomBeneficiario desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_PlazaInternacional' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY PlazaInternacional 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_PlazaInternacional' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY PlazaInternacional desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Pais' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Pais 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Pais' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Pais desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ClaveSiacInst' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ClaveSiacInst 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ClaveSiacInst' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ClaveSiacInst desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ConvenioCieDie' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ConvenioCieDie 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ConvenioCieDie' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ConvenioCieDie desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Estatus' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Estatus 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Estatus' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Estatus desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Clabe' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Clabe 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Clabe' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Clabe desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_CuentaChequera' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY CuentaChequera 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_CuentaChequera' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY CuentaChequera desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_FechaVence' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY FechaVence 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_FechaVence' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY FechaVence desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_NumAbbasSwift' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY NumAbbasSwift 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_NumAbbasSwift' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY NumAbbasSwift desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_ConceptoSiac' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ConceptoSiac 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_ConceptoSiac' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY ConceptoSiac desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_RefCieDie' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY RefCieDie 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_RefCieDie' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY RefCieDie desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'CuentaCheques_Autorizacion' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Autorizacion 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'CuentaCheques_Autorizacion' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM CuentaCheques
                ORDER BY Autorizacion desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
 
      
        
END

GO


-------------------------------------------------///////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad BY ID SP//////////--------------------------------------------------------------------
-------------------------------------------------//////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:13:01 PM
-- CRUD Stored Procedures spGetListEntidadById
Create Procedure [dbo].[spGetCuentaChequesByID] 
@ID int
AS
BEGIN
    SET NOCOUNT ON;
    select  
   CuentaCheques.ID ,
CuentaCheques.Fideicomiso ,
CuentaCheques.TipoPersona ,
CuentaCheques.Fideicomitente ,
CuentaCheques.TipoCuenta ,
CuentaCheques.TipoPago ,
CuentaCheques.BancoSpei ,
CuentaCheques.Banco ,
CuentaCheques.DomBanco ,
CuentaCheques.Moneda ,
CuentaCheques.ClaveVostro ,
CuentaCheques.NumCuenta ,
CuentaCheques.DomBeneficiario ,
CuentaCheques.PlazaInternacional ,
CuentaCheques.Pais ,
CuentaCheques.ClaveSiacInst ,
CuentaCheques.ConvenioCieDie ,
CuentaCheques.Estatus ,
CuentaCheques.Clabe ,
CuentaCheques.CuentaChequera ,
CuentaCheques.FechaVence ,
CuentaCheques.NumAbbasSwift ,
CuentaCheques.ConceptoSiac ,
CuentaCheques.RefCieDie ,
CuentaCheques.Autorizacion 
         , Fideicomiso1.GeneralesNumero as GeneralesNumero1
, Fideicomitente2.NumeroFideicomitente as NumeroFideicomitente2
    from CuentaCheques  left join Fideicomiso as Fideicomiso1 on CuentaCheques.Fideicomiso = Fideicomiso1.ID
 left join Fideicomitente as Fideicomitente2 on CuentaCheques.Fideicomitente = Fideicomitente2.ID

    where CuentaCheques.ID = @ID;

		
END

GO







