      

--Fecha Creación:5/24/2019 6:12:54 PM Template TableAndStoreds, Author: Alfredo Reyes C., V1

IF OBJECT_ID('[dbo].[ContratoInversion]', 'U') IS NOT NULL 
Drop Table [dbo].[ContratoInversion]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spDeleteContratoInversion]') AND type in (N'P', N'PC'))
    Drop Procedure spDeleteContratoInversion
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spUpdateContratoInversion]') AND type in (N'P', N'PC'))
    Drop Procedure spUpdateContratoInversion
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spUpdatePartialContratoInversion]') AND type in (N'P', N'PC'))
    Drop Procedure spUpdatePartialContratoInversion
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spInsertContratoInversion]') AND type in (N'P', N'PC'))
    Drop Procedure spInsertContratoInversion
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetListContratoInversionPaged]') AND type in (N'P', N'PC'))
    Drop Procedure spGetListContratoInversionPaged
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetListContratoInversionAndRelationsPaged]') AND type in (N'P', N'PC'))
    Drop Procedure spGetListContratoInversionAndRelationsPaged
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[spGetContratoInversionByID]') AND type in (N'P', N'PC'))
    Drop Procedure spGetContratoInversionByID
GO


-------------------------------------------------//////////////////--------------------------------------------------------------------
----Datos para la seguridad de los servicios
-----------------------------------------------------

-------------------------------------------------//////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
--Add Columns to Table must be null 



-------------------------------------------------/////////CREAR TABLA/////////--------------------------------------------------------------------
-------------------------------------------------//////////////////--------------------------------------------------------------------
--CRUD Tabla SQL
Create Table [dbo].[ContratoInversion](
                        [ID] int--%>
                        IDENTITY (1,1)  ,
            
                   
 [Fideicomiso] int
                NOT NULL ,
       
 [TipoContrato] varchar(250)
                NULL ,
       
 [Intermediario] varchar(250)
                NULL ,
       
 [Moneda] varchar(250)
                NULL ,
       
 [NombreContacto1] varchar(250)
                NULL ,
       
 [NombreContacto2] varchar(250)
                NULL ,
       
 [ResParamLiq] varchar(250)
                NULL ,
       
 [EnvioRecursosInv] varchar(250)
                NULL ,
       
 [TransferenciaRecDesinver] varchar(250)
                NULL ,
       
 [RetenerIsr] varchar(250)
                NULL ,
       
 [Subfiso] int
                NULL ,
       
 [FechaVencimiento] date
                NULL ,
       
 [Estatus] varchar(250)
                NULL ,
       
 [ContratoIversion] varchar(250)
                NULL ,
       
 [ContratoOtrasInst] varchar(250)
                NULL ,
       
 [Contacto1Lada] varchar(250)
                NULL ,
       
 [Contacto1Telefono] varchar(250)
                NULL ,
       
 [Contacto1Ext] varchar(250)
                NULL ,
       
 [Contacto2Lada] varchar(250)
                NULL ,
       
 [Contacto2Telefono] varchar(250)
                NULL ,
       
 [Contacto2Ext] varchar(250)
                NULL ,
       
 [Nombre] varchar(250)
                NULL ,
       
 [Cuenta] varchar(250)
                NULL ,
       
 [TraspasoEntreSubFiso] varchar(250)
                NULL ,
       
 [FechaApertura] date
                NULL ,
       
 [OrigenRecursos] varchar(250)
                NULL 
       
    CONSTRAINT [PK_ContratoInversion] PRIMARY KEY CLUSTERED
    (
    [ID] ASC
        )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
        ) ON [PRIMARY]

GO


---Añadimos lo constraints de ForeignKeys 
        ALTER TABLE [dbo].[ContratoInversion]  WITH CHECK ADD FOREIGN KEY([Fideicomiso])
        REFERENCES [dbo].[Fideicomiso] ([ID])
        GO
        ALTER TABLE [dbo].[ContratoInversion]  WITH CHECK ADD FOREIGN KEY([Subfiso])
        REFERENCES [dbo].[Subfiso] ([ID])
        GO


-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------/////////Insert SP/////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spInsertContratoInversion]
      @Fideicomiso int  ,
@TipoContrato varchar(250) NULL ,
@Intermediario varchar(250) NULL ,
@Moneda varchar(250) NULL ,
@NombreContacto1 varchar(250) NULL ,
@NombreContacto2 varchar(250) NULL ,
@ResParamLiq varchar(250) NULL ,
@EnvioRecursosInv varchar(250) NULL ,
@TransferenciaRecDesinver varchar(250) NULL ,
@RetenerIsr varchar(250) NULL ,
@Subfiso int NULL ,
@FechaVencimiento date NULL ,
@Estatus varchar(250) NULL ,
@ContratoIversion varchar(250) NULL ,
@ContratoOtrasInst varchar(250) NULL ,
@Contacto1Lada varchar(250) NULL ,
@Contacto1Telefono varchar(250) NULL ,
@Contacto1Ext varchar(250) NULL ,
@Contacto2Lada varchar(250) NULL ,
@Contacto2Telefono varchar(250) NULL ,
@Contacto2Ext varchar(250) NULL ,
@Nombre varchar(250) NULL ,
@Cuenta varchar(250) NULL ,
@TraspasoEntreSubFiso varchar(250) NULL ,
@FechaApertura date NULL ,
@OrigenRecursos varchar(250) NULL ,
    @ReturnValue int output
AS
BEGIN
   
    SET NOCOUNT ON;
    Insert into ContratoInversion (
     Fideicomiso,TipoContrato,Intermediario,Moneda,NombreContacto1,NombreContacto2,ResParamLiq,EnvioRecursosInv,TransferenciaRecDesinver,RetenerIsr,Subfiso,FechaVencimiento,Estatus,ContratoIversion,ContratoOtrasInst,Contacto1Lada,Contacto1Telefono,Contacto1Ext,Contacto2Lada,Contacto2Telefono,Contacto2Ext,Nombre,Cuenta,TraspasoEntreSubFiso,FechaApertura,OrigenRecursos
    )     
    values (  
    @Fideicomiso,@TipoContrato,@Intermediario,@Moneda,@NombreContacto1,@NombreContacto2,@ResParamLiq,@EnvioRecursosInv,@TransferenciaRecDesinver,@RetenerIsr,@Subfiso,@FechaVencimiento,@Estatus,@ContratoIversion,@ContratoOtrasInst,@Contacto1Lada,@Contacto1Telefono,@Contacto1Ext,@Contacto2Lada,@Contacto2Telefono,@Contacto2Ext,@Nombre,@Cuenta,@TraspasoEntreSubFiso,@FechaApertura,@OrigenRecursos
    );

		--select @ReturnValue = Max(ID) from ContratoInversion;
        select @ReturnValue = 1;
END

GO

-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------///////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////////Update SP//////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spUpdateContratoInversion]
      @ID int ,
@Fideicomiso int ,
@TipoContrato varchar(250) NULL,
@Intermediario varchar(250) NULL,
@Moneda varchar(250) NULL,
@NombreContacto1 varchar(250) NULL,
@NombreContacto2 varchar(250) NULL,
@ResParamLiq varchar(250) NULL,
@EnvioRecursosInv varchar(250) NULL,
@TransferenciaRecDesinver varchar(250) NULL,
@RetenerIsr varchar(250) NULL,
@Subfiso int NULL,
@FechaVencimiento date NULL,
@Estatus varchar(250) NULL,
@ContratoIversion varchar(250) NULL,
@ContratoOtrasInst varchar(250) NULL,
@Contacto1Lada varchar(250) NULL,
@Contacto1Telefono varchar(250) NULL,
@Contacto1Ext varchar(250) NULL,
@Contacto2Lada varchar(250) NULL,
@Contacto2Telefono varchar(250) NULL,
@Contacto2Ext varchar(250) NULL,
@Nombre varchar(250) NULL,
@Cuenta varchar(250) NULL,
@TraspasoEntreSubFiso varchar(250) NULL,
@FechaApertura date NULL,
@OrigenRecursos varchar(250) NULL,
    @ReturnValue int output
AS
BEGIN
    SET NOCOUNT ON;
    Update ContratoInversion set 
        Fideicomiso = @Fideicomiso,TipoContrato = @TipoContrato,Intermediario = @Intermediario,Moneda = @Moneda,NombreContacto1 = @NombreContacto1,NombreContacto2 = @NombreContacto2,ResParamLiq = @ResParamLiq,EnvioRecursosInv = @EnvioRecursosInv,TransferenciaRecDesinver = @TransferenciaRecDesinver,RetenerIsr = @RetenerIsr,Subfiso = @Subfiso,FechaVencimiento = @FechaVencimiento,Estatus = @Estatus,ContratoIversion = @ContratoIversion,ContratoOtrasInst = @ContratoOtrasInst,Contacto1Lada = @Contacto1Lada,Contacto1Telefono = @Contacto1Telefono,Contacto1Ext = @Contacto1Ext,Contacto2Lada = @Contacto2Lada,Contacto2Telefono = @Contacto2Telefono,Contacto2Ext = @Contacto2Ext,Nombre = @Nombre,Cuenta = @Cuenta,TraspasoEntreSubFiso = @TraspasoEntreSubFiso,FechaApertura = @FechaApertura,OrigenRecursos = @OrigenRecursos
    where ID = @ID;

		select @ReturnValue = 1;
END

GO
-------------------------------------------------/////////////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------/////////////Update SP Partial///////////--------------------------------------------------------------------
-------------------------------------------------////////////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures
Create Procedure [dbo].[spUpdatePartialContratoInversion]
      @ID int ,
@Fideicomiso int ,
@TipoContrato varchar(250) NULL,
@Intermediario varchar(250) NULL,
@Moneda varchar(250) NULL,
@NombreContacto1 varchar(250) NULL,
@NombreContacto2 varchar(250) NULL,
@ResParamLiq varchar(250) NULL,
@EnvioRecursosInv varchar(250) NULL,
@TransferenciaRecDesinver varchar(250) NULL,
@RetenerIsr varchar(250) NULL,
@Subfiso int NULL,
@FechaVencimiento date NULL,
@Estatus varchar(250) NULL,
@ContratoIversion varchar(250) NULL,
@ContratoOtrasInst varchar(250) NULL,
@Contacto1Lada varchar(250) NULL,
@Contacto1Telefono varchar(250) NULL,
@Contacto1Ext varchar(250) NULL,
@Contacto2Lada varchar(250) NULL,
@Contacto2Telefono varchar(250) NULL,
@Contacto2Ext varchar(250) NULL,
@Nombre varchar(250) NULL,
@Cuenta varchar(250) NULL,
@TraspasoEntreSubFiso varchar(250) NULL,
@FechaApertura date NULL,
@OrigenRecursos varchar(250) NULL,
    @ReturnValue int output
AS
BEGIN
    SET NOCOUNT ON;
    Update ContratoInversion set 
        Fideicomiso = @Fideicomiso,TipoContrato = @TipoContrato,Intermediario = @Intermediario,Moneda = @Moneda,NombreContacto1 = @NombreContacto1,NombreContacto2 = @NombreContacto2,ResParamLiq = @ResParamLiq,EnvioRecursosInv = @EnvioRecursosInv,TransferenciaRecDesinver = @TransferenciaRecDesinver,RetenerIsr = @RetenerIsr,Subfiso = @Subfiso,FechaVencimiento = @FechaVencimiento,Estatus = @Estatus,ContratoIversion = @ContratoIversion,ContratoOtrasInst = @ContratoOtrasInst,Contacto1Lada = @Contacto1Lada,Contacto1Telefono = @Contacto1Telefono,Contacto1Ext = @Contacto1Ext,Contacto2Lada = @Contacto2Lada,Contacto2Telefono = @Contacto2Telefono,Contacto2Ext = @Contacto2Ext,Nombre = @Nombre,Cuenta = @Cuenta,TraspasoEntreSubFiso = @TraspasoEntreSubFiso,FechaApertura = @FechaApertura,OrigenRecursos = @OrigenRecursos
    where ID = @ID;

		select @ReturnValue = 1;
END

GO
-------------------------------------------------////////////////////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad Rwlations SP//////////--------------------------------------------------------------------
-------------------------------------------------////////////////////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures spGetListEntidadSQLAndRelationsPaged
Create Procedure [dbo].[spGetListContratoInversionAndRelationsPaged]
     @pagNo int, 
    @pageSize int,
    @sort varchar(50) = '',
	@sortdir varchar(10) = ''
AS
BEGIN

  SET NOCOUNT ON;
   declare @ReturnCount int;
    select @ReturnCount = count(ID) from ContratoInversion;
    
            if @sort = 'ContratoInversion_ID' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ID
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ID' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ID desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
                
            if @sort = '' 
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ID
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
                 
            if @sort = 'MyFideicomiso1.Fideicomiso_GeneralesNumero' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY Fideicomiso1.GeneralesNumero
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'MyFideicomiso1.Fideicomiso_GeneralesNumero' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY Fideicomiso1.GeneralesNumero desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TipoContrato' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TipoContrato
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TipoContrato' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TipoContrato desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Intermediario' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Intermediario
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Intermediario' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Intermediario desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Moneda' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Moneda
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Moneda' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Moneda desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_NombreContacto1' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.NombreContacto1
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_NombreContacto1' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.NombreContacto1 desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_NombreContacto2' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.NombreContacto2
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_NombreContacto2' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.NombreContacto2 desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ResParamLiq' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ResParamLiq
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ResParamLiq' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ResParamLiq desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_EnvioRecursosInv' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.EnvioRecursosInv
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_EnvioRecursosInv' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.EnvioRecursosInv desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TransferenciaRecDesinver' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TransferenciaRecDesinver
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TransferenciaRecDesinver' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TransferenciaRecDesinver desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_RetenerIsr' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.RetenerIsr
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_RetenerIsr' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.RetenerIsr desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'MySubfiso2.Subfiso_Numero' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY Subfiso2.Numero
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'MySubfiso2.Subfiso_Numero' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY Subfiso2.Numero desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_FechaVencimiento' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.FechaVencimiento
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_FechaVencimiento' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.FechaVencimiento desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Estatus' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Estatus
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Estatus' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Estatus desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ContratoIversion' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ContratoIversion
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ContratoIversion' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ContratoIversion desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ContratoOtrasInst' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ContratoOtrasInst
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ContratoOtrasInst' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.ContratoOtrasInst desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Lada' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Lada
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Lada' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Lada desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Telefono' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Telefono
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Telefono' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Telefono desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Ext' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Ext
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Ext' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto1Ext desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Lada' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Lada
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Lada' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Lada desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Telefono' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Telefono
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Telefono' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Telefono desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Ext' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Ext
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Ext' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Contacto2Ext desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Nombre' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Nombre
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Nombre' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Nombre desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Cuenta' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Cuenta
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Cuenta' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.Cuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TraspasoEntreSubFiso' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TraspasoEntreSubFiso
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TraspasoEntreSubFiso' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.TraspasoEntreSubFiso desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_FechaApertura' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.FechaApertura
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_FechaApertura' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.FechaApertura desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_OrigenRecursos' and @sortdir = 'ASC'
            Begin
               SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.OrigenRecursos
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_OrigenRecursos' and @sortdir <> 'ASC'
            Begin
                SELECT ContratoInversion.ID,ContratoInversion.Fideicomiso,ContratoInversion.TipoContrato,ContratoInversion.Intermediario,ContratoInversion.Moneda,ContratoInversion.NombreContacto1,ContratoInversion.NombreContacto2,ContratoInversion.ResParamLiq,ContratoInversion.EnvioRecursosInv,ContratoInversion.TransferenciaRecDesinver,ContratoInversion.RetenerIsr,ContratoInversion.Subfiso,ContratoInversion.FechaVencimiento,ContratoInversion.Estatus,ContratoInversion.ContratoIversion,ContratoInversion.ContratoOtrasInst,ContratoInversion.Contacto1Lada,ContratoInversion.Contacto1Telefono,ContratoInversion.Contacto1Ext,ContratoInversion.Contacto2Lada,ContratoInversion.Contacto2Telefono,ContratoInversion.Contacto2Ext,ContratoInversion.Nombre,ContratoInversion.Cuenta,ContratoInversion.TraspasoEntreSubFiso,ContratoInversion.FechaApertura,ContratoInversion.OrigenRecursos,Fideicomiso1.ID as ID1,Fideicomiso1.GeneralesNumero as GeneralesNumero1,Fideicomiso1.GeneralesNombre as GeneralesNombre1,Fideicomiso1.GeneralesAdministrador as GeneralesAdministrador1,Fideicomiso1.GeneralesPromotor as GeneralesPromotor1,Fideicomiso1.CaracteristicasFormaManejo as CaracteristicasFormaManejo1,Fideicomiso1.CaracteristicasTipoNegocio as CaracteristicasTipoNegocio1,Fideicomiso1.CaracteristicasClasificacionProducto as CaracteristicasClasificacionProducto1,Fideicomiso1.CaracteristicasProductoEstandar as CaracteristicasProductoEstandar1,Fideicomiso1.CaracteristicasProducto as CaracteristicasProducto1,Fideicomiso1.CaracteristicasValFatca as CaracteristicasValFatca1,Fideicomiso1.CaracteristicasMontoApertura as CaracteristicasMontoApertura1,Fideicomiso1.CaracteristicasManejoSubFisos as CaracteristicasManejoSubFisos1,Fideicomiso1.CaracteristicasSujetoArt151 as CaracteristicasSujetoArt1511,Fideicomiso1.CaracteristicasCerrado as CaracteristicasCerrado1,Fideicomiso1.CaracteristicasRevocable as CaracteristicasRevocable1,Fideicomiso1.CaracteristicasEsContratoEje as CaracteristicasEsContratoEje1,Fideicomiso1.CaracteristicasComiteTecnico as CaracteristicasComiteTecnico1,Fideicomiso1.CaracteristicasOfiBanxico as CaracteristicasOfiBanxico1,Fideicomiso1.CaracteristicasManejaMonExt as CaracteristicasManejaMonExt1,Fideicomiso1.CaracteristicasIvaFronterizo as CaracteristicasIvaFronterizo1,Fideicomiso1.CaracteristicasFechaAlta as CaracteristicasFechaAlta1,Fideicomiso1.CaracteristicasFechaConstitucion as CaracteristicasFechaConstitucion1,Fideicomiso1.CaracteristicasFechaAprobacion as CaracteristicasFechaAprobacion1,Fideicomiso1.CaracteristicasEstado as CaracteristicasEstado1,Fideicomiso1.AdicionalesTipo as AdicionalesTipo1,Fideicomiso1.AdicionalesTipoPersona as AdicionalesTipoPersona1,Fideicomiso1.AdicionalesConActividadEmpresarial as AdicionalesConActividadEmpresarial1,Fideicomiso1.AdicionalesPermisoSre as AdicionalesPermisoSre1,Fideicomiso1.AdicionalesFechaPermisoSre as AdicionalesFechaPermisoSre1,Fideicomiso1.AdicionalesProvSustFiduciaria as AdicionalesProvSustFiduciaria1,Fideicomiso1.AdicionalesFondosInterfaseAfore as AdicionalesFondosInterfaseAfore1,Fideicomiso1.AdicionalesRegNalInvExt as AdicionalesRegNalInvExt1,Fideicomiso1.AdicionalesFechaInscripcion as AdicionalesFechaInscripcion1,Fideicomiso1.AdicionalesFormalizacionContrato as AdicionalesFormalizacionContrato1,Fideicomiso1.AdicionalesNoEscritura as AdicionalesNoEscritura1,Fideicomiso1.AdicionalesFechaEscritura as AdicionalesFechaEscritura1,Fideicomiso1.AdicionalesNombreNotario as AdicionalesNombreNotario1,Fideicomiso1.AdicionalesNoNotario as AdicionalesNoNotario1,Fideicomiso1.AdicionalesCiudadNotario as AdicionalesCiudadNotario1,Fideicomiso1.AdicionalesEstadoNotario as AdicionalesEstadoNotario1,Fideicomiso1.AdicionalesPaisNotario as AdicionalesPaisNotario1,Fideicomiso1.AdicionalesFolioRegistroPublico as AdicionalesFolioRegistroPublico1,Fideicomiso1.AdicionalesFechaInscripcionRegPublico as AdicionalesFechaInscripcionRegPublico1,Fideicomiso1.AdicionalesAdministracion as AdicionalesAdministracion1,Fideicomiso1.AdicionalesContabilidadDelegada as AdicionalesContabilidadDelegada1,Fideicomiso1.DatosBanxicoActividadEconomica as DatosBanxicoActividadEconomica1,Fideicomiso1.DatosBanxicoFiducuario as DatosBanxicoFiducuario1,Fideicomiso1.DatosBanxicoSectorBancario as DatosBanxicoSectorBancario1,Fideicomiso1.DatosBanxicoLocalidad as DatosBanxicoLocalidad1,Fideicomiso1.DatosBanxicoCentroResp as DatosBanxicoCentroResp1,Fideicomiso1.DatosBanxicoNoCr as DatosBanxicoNoCr1,Fideicomiso1.DatosBanxicoRfcContrato as DatosBanxicoRfcContrato1,Fideicomiso1.DatosBanxicoNumeroCliente as DatosBanxicoNumeroCliente1,Subfiso2.ID as ID2,Subfiso2.Fideicomiso as Fideicomiso2,Subfiso2.Numero as Numero2,Subfiso2.Nombre as Nombre2,Subfiso2.Estatus as Estatus2,Subfiso2.FechaRegistro as FechaRegistro2,Subfiso2.Identificador as Identificador2,@ReturnCount as TotalRecords
                FROM ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

                ORDER BY ContratoInversion.OrigenRecursos desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
 
      
        
END

GO
-------------------------------------------------///////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad//////////--------------------------------------------------------------------
-------------------------------------------------//////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures spGetListEntidadSQLPaged
Create Procedure [dbo].[spGetListContratoInversionPaged]
     @pagNo int, 
    @pageSize int,
    @sort varchar(50) = '',
	@sortdir varchar(10) = ''
AS
BEGIN

 SET NOCOUNT ON;
   declare @ReturnCount int;
    select @ReturnCount = count(ID) from ContratoInversion;
    
            if @sort = 'ContratoInversion_ID' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ID 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ID' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ID desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
                if @sort = ''
                Begin
                   SELECT *,@ReturnCount as TotalRecords
                    FROM ContratoInversion
                    ORDER BY ID 
                    OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                    FETCH NEXT @pageSize  ROWS ONLY;

              End
            if @sort = 'ContratoInversion_Fideicomiso' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Fideicomiso 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Fideicomiso' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Fideicomiso desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TipoContrato' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TipoContrato 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TipoContrato' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TipoContrato desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Intermediario' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Intermediario 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Intermediario' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Intermediario desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Moneda' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Moneda 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Moneda' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Moneda desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_NombreContacto1' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY NombreContacto1 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_NombreContacto1' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY NombreContacto1 desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_NombreContacto2' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY NombreContacto2 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_NombreContacto2' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY NombreContacto2 desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ResParamLiq' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ResParamLiq 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ResParamLiq' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ResParamLiq desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_EnvioRecursosInv' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY EnvioRecursosInv 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_EnvioRecursosInv' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY EnvioRecursosInv desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TransferenciaRecDesinver' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TransferenciaRecDesinver 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TransferenciaRecDesinver' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TransferenciaRecDesinver desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_RetenerIsr' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY RetenerIsr 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_RetenerIsr' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY RetenerIsr desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Subfiso' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Subfiso 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Subfiso' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Subfiso desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_FechaVencimiento' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY FechaVencimiento 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_FechaVencimiento' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY FechaVencimiento desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Estatus' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Estatus 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Estatus' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Estatus desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ContratoIversion' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ContratoIversion 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ContratoIversion' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ContratoIversion desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_ContratoOtrasInst' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ContratoOtrasInst 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_ContratoOtrasInst' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY ContratoOtrasInst desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Lada' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Lada 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Lada' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Lada desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Telefono' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Telefono 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Telefono' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Telefono desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto1Ext' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Ext 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto1Ext' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto1Ext desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Lada' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Lada 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Lada' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Lada desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Telefono' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Telefono 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Telefono' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Telefono desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Contacto2Ext' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Ext 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Contacto2Ext' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Contacto2Ext desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Nombre' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Nombre 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Nombre' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Nombre desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_Cuenta' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Cuenta 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_Cuenta' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY Cuenta desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_TraspasoEntreSubFiso' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TraspasoEntreSubFiso 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_TraspasoEntreSubFiso' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY TraspasoEntreSubFiso desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_FechaApertura' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY FechaApertura 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_FechaApertura' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY FechaApertura desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
            if @sort = 'ContratoInversion_OrigenRecursos' and @sortdir = 'ASC'
            Begin
               SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY OrigenRecursos 
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END
            Else if @sort = 'ContratoInversion_OrigenRecursos' and @sortdir <> 'ASC'
            Begin
                SELECT *,@ReturnCount as TotalRecords
                FROM ContratoInversion
                ORDER BY OrigenRecursos desc
                OFFSET ((@pagNo - 1)  * @pageSize) ROWS
                FETCH NEXT @pageSize  ROWS ONLY;

            END 
 
      
        
END

GO


-------------------------------------------------///////////////////////////////////--------------------------------------------------------------------
-------------------------------------------------////////Get List  Entidad BY ID SP//////////--------------------------------------------------------------------
-------------------------------------------------//////////////////////////////////--------------------------------------------------------------------
--Fecha Creación:5/24/2019 6:12:54 PM
-- CRUD Stored Procedures spGetListEntidadById
Create Procedure [dbo].[spGetContratoInversionByID] 
@ID int
AS
BEGIN
    SET NOCOUNT ON;
    select  
   ContratoInversion.ID ,
ContratoInversion.Fideicomiso ,
ContratoInversion.TipoContrato ,
ContratoInversion.Intermediario ,
ContratoInversion.Moneda ,
ContratoInversion.NombreContacto1 ,
ContratoInversion.NombreContacto2 ,
ContratoInversion.ResParamLiq ,
ContratoInversion.EnvioRecursosInv ,
ContratoInversion.TransferenciaRecDesinver ,
ContratoInversion.RetenerIsr ,
ContratoInversion.Subfiso ,
ContratoInversion.FechaVencimiento ,
ContratoInversion.Estatus ,
ContratoInversion.ContratoIversion ,
ContratoInversion.ContratoOtrasInst ,
ContratoInversion.Contacto1Lada ,
ContratoInversion.Contacto1Telefono ,
ContratoInversion.Contacto1Ext ,
ContratoInversion.Contacto2Lada ,
ContratoInversion.Contacto2Telefono ,
ContratoInversion.Contacto2Ext ,
ContratoInversion.Nombre ,
ContratoInversion.Cuenta ,
ContratoInversion.TraspasoEntreSubFiso ,
ContratoInversion.FechaApertura ,
ContratoInversion.OrigenRecursos 
         , Fideicomiso1.GeneralesNumero as GeneralesNumero1
, Subfiso2.Numero as Numero2
    from ContratoInversion  left join Fideicomiso as Fideicomiso1 on ContratoInversion.Fideicomiso = Fideicomiso1.ID
 left join Subfiso as Subfiso2 on ContratoInversion.Subfiso = Subfiso2.ID

    where ContratoInversion.ID = @ID;

		
END

GO







